{% extends "forum_base.html" %}
{% load engine_tags %}
{% load forum_tags %}


{% block headtitle %}{{ user.profile.name }}{% endblock %}

{% block body %}


<div class="ui center aligned header"> {{ user.profile.get_role_display }}: {{ user.profile.name }}</div>

    <div class="ui relaxed grid">

<div class="row">
    <div class="five wide column">
        <div class="ui center aligned basic large segment">
          <div class="ui rounded image">
            <a href="{% url "public_profile" user.profile.uid %}">{% gravatar user=user size=200 %}</a>

            </div>
            <div>
        {{user.profile.name}} {{ user.profile.score |show_score_icon}}  {{ user.profile.score | show_score |bignum }}
            </div>
        </div>

    </div>

    <div class="five wide column">


        <div class="ui left aligned basic large segment">

            <div>
            <b>Reputation</b> : {{ user.profile.score | show_score }}
            </div>
            <div>
            <b>Status</b> : {{ user.profile.get_state_display }}
            </div>
            <div>
            <b>Location</b> : {{ user.profile.location }}
            </div>

            {% if user.profile.last_login  %}
                <div>
                <b>Last seen </b> : {{ user.profile.last_login |time_ago}}
                </div>
            {%  endif %}

            <div>
                <b>Joined</b> : {{ user.profile.date_joined|time_ago }}

            </div>
            <div> <b>Email</b> : {{ user |show_email }}
            </div>

        </div>

        {%  if user == request.user %}

             <div class="ui center aligned basic vertical segment">
                  <div class="ui mini buttons">
                     <a class="ui mini button" href="{% url 'edit_profile'%}">
                        <i class="write icon"></i>Edit profile
                    </a>
                      <div class="or"></div>
                    <a class="ui mini button" href="{% url 'recycle_bin' %}">
                        <i class="trash icon"></i>Recycle Bin
                    </a>
                  </div>
             </div>

            <div class="ui center aligned vertical basic segment">

                {% if user.profile.notify %}
                  <div class="ui vertical basic segment">
                    Email notifications are <b>enabled</b>. You will receive an email every time your recipe has finished running.
                  </div>

                    <a class="ui mini red button" href="{% url 'toggle_notify' %}">
                        <i class="bell slash icon"></i>Disable Email Notifications
                    </a>
                    {% else %}
                    <a class="ui mini green button" href="{% url 'toggle_notify' %}">
                        <i class="bell icon"></i>Enable Email Notifications
                    </a>
                {% endif %}
            </div>



        {% endif %}




    </div>



    <div class="six wide column">


        {{ user.profile.html |safe }}


    </div>
</div>

    <div class="row">

        <div class="sixteen wide column">
        <div class="ui top attached tabular large menu">

        <div class="{{ posts }} item">
            <a href="{% url "public_profile" user.profile.uid %}?active=posts">
                Posts
            </a>

        </div>



        <div class="{{ projects }} item">

        <a href="{% url "public_profile" user.profile.uid %}?active=projects">
           Projects
        </a>


        </div>

            {% if user.profile.is_manager  and user == request.user %}
                <div class="{{ recipes }} item">

                    <a href="{% url "public_profile" user.profile.uid %}?active=recipes">
                       Recipes to Manage
                    </a>

                </div>

            {%  endif %}



        </div>

        {% if posts %}


        {% get_posts user=user request=request as posts %}
        {% pages objs=posts request=request uid=user.profile.uid url="public_profile" %}

        <div class="ui small relaxed divided list">

            {% listing posts=posts %}

        </div>

        {% pages objs=posts request=request uid=user.profile.uid url="public_profile" %}


        {% elif projects %}

            {% get_projects user=user request=request as projects %}
            {% pages objs=projects request=request uid=user.profile.uid url="public_profile" %}
            {% list_view projects=projects %}

            {% if not projects %}
            <div class="ui warning message"><i class="ui warning circle icon"></i> No projects found.</div>
            {% endif %}
            {% pages objs=projects request=request uid=user.profile.uid url="public_profile" %}


        {% elif recipes and user.profile.is_manager  and user == request.user %}


        {% endif %}




        </div>



    </div>




    </div>



{%  endblock %}