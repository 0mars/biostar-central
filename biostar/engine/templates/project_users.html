{% extends "base.html" %}
{% load engine_tags %}
{% load staticfiles %}

{% block headtitle %}
    Managing people: {{ project.name }}
{% endblock %}

{% block body %}

<div class="ui raised segments">

    <div class="ui center aligned segment">

        <div class="ui tiny image">
            <img src="{% img project %}">
        </div>

        <div class="ui header">
            Managing people: {{ project.name }}
        </div>

    </div>

    <div class="ui secondary segment">
        <p> {{ project.summary|markdown|safe }}</p>
        Adding grants users
        <span class="ui green label">{{ access.get_access_display }} Permission</span>
        to this project

    </div>

    <div class="ui segment">
        <div class="ui fluid search">
            <div class="ui icon input">
                <form method="get" action="{% url 'project_users' project.id %}">

                    <input type="text" name="searches" placeholder="Search people...">

                     <button type="submit" class="ui button">
                        <i class="search large icon"></i>
                    </button>
                </form>
            </div>
        </div>
    </div>

<div class="ui segment">
         <form class="ui large form" method="post" action="{% url 'project_users' project.id %}">
                {% csrf_token %}
         <div class="ui segment">
            <div class="content">
            <div class="ui header"> Search</div>
             <button type="submit" class="ui green mini button" name="add_or_remove" formmethod="post" value="add">
                <i class="add user icon"></i>Add people
            </button>
                <div class="ui relaxed divided list">
                    {% for new_user in available_users %}
                        <div class="item">

                            <div class="inline field">

                                <input type="checkbox" name="users" value="{{new_user.id}}">

                                    <i class="user icon"></i>{{ new_user.first_name }}

                            </div>

                        </div>
                    {% endfor %}

                </div>
            </div>
        </div>

         <div class="ui segment">


                <div class="ui header">Contributors</div>

                <button type="submit" class="ui red mini button" name="add_or_remove" formmethod="post" value="remove">
                    <i class="remove user icon"></i>Remove people
                </button>

                <div class="ui relaxed divided list">
                    {% for avail_user in current_users %}
                         <div class="item">
                            <div class="inline field">

                                    {% if avail_user == project.owner %}
                                        <i class="user icon"></i>{{ avail_user.first_name }}
                                        <div class="ui left pointing tiny label">
                                          Creator
                                        </div>
                                    {% else %}
                                        <input type="checkbox" name="users" value="{{avail_user.id}}">
                                            <i class="user icon"></i>{{ avail_user.first_name }}
                                    {% endif %}

                            </div>
                         </div>
                    {% endfor %}
                </div>
             </div>

         {{form.errors}}
     </form>
    </div>
</div>
{% endblock %}