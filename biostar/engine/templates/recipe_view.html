{% extends "base_content.html" %}
{% load engine_tags %}
{% load staticfiles %}

{% block headtitle %}
    {{ analysis.name }}
{% endblock %}


{% block menu %}
    {% menubar edit_analysis=True analysis=analysis %}
{% endblock %}

{% block breadcrumb %}
    {% breadcrumb steps=steps %}
{% endblock %}

{% block js %}
    <script src="{% static 'lib/codemirror.js' %}"></script>
    <script src="{% static 'lib/mode/simple.js' %}"></script>
    <script src="{% static 'lib/mode/engine.js' %}"></script>
{% endblock %}

{% block content %}
    <div class="ui vertical segment">

        <div class="ui vertical segment">

            <div class="ui center aligned header">
                Recipe: <i class="setting icon"></i>{{ analysis.name }}
            </div>

            <div class="">
                <img class="ui centered small image" src="{% img analysis %}">
            </div>

            {% security_label analysis %}

            <div class="ui center aligned basic segment">
                <div class="ui buttons">
                    <a class="ui green button" href="{% url 'analysis_run' analysis.id %}">
                        <i class="spinner icon"></i> Run Recipe
                    </a>

                    <div class="or"></div>

                    <a class="ui teal button" href="{% url 'job_list' project.uid %}?filter={{ analysis.id }}">
                        <i class="bar chart icon"></i>View Results
                    </a>

                    <div class="or"></div>

                     <a class="ui button" href="{% url 'recipe_code' analysis.id %}">
                        <i class="list icon"></i>Edit Code
                    </a>

                    {% if user.is_authenticated %}

                        <div class="or"></div>

                        <a class="ui button" href="{% url 'recipe_copy' analysis.id %}">
                            <i class="clone icon"></i>Copy
                        </a>

                        <div class="or"></div>

                        <a class="ui button" href="{% url 'recipe_edit' analysis.id %}">
                            <i class="write icon"></i>Edit
                        </a>

                    {% endif %}



                </div>


            </div>
        </div>


        <div class="ui vertical segment">
            {{ analysis.html|safe }}
        </div>


        <div class="ui vertical segment">
            <div class="ui header">Recipe Template</div>
            <p>The actions performed by this recipe.</p>
            <pre class="code" style="width:100%; min-height: 300px" id="foo">{{ analysis.template }}</pre>
        </div>

    </div>

{% endblock %}


