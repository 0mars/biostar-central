{% extends "base.html" %}
{% load engine_tags %}

{% block headtitle %}
    {{ analysis.name }}
{% endblock %}


{% block menu %}
    {% menubar edit_analysis=True analysis=analysis %}
{% endblock %}

{% block breadcrumb %}
    {% breadcrumb steps=steps %}
{% endblock %}

{% block body %}

    <div class="ui raised segments">

        {% project_name_bar project %}

        <div class="ui segment">

            <div class="ui center aligned header">
                Recipe: {{ analysis.name }}
            </div>

            <div class="">
                <img class="ui centered small image" src="{% img analysis %}">
            </div>
            <div class="ui center aligned basic segment">
                <a class="ui green button" href="{% url 'analysis_run' analysis.id %}">
                    <i class="spinner icon"></i> Execute Recipe
                </a>
            </div>
            <p>
                {{ analysis.summary|markdown|safe }}
            </p>

            {% security_label analysis %}

        </div>

        <div class="ui center aligned segment">

            <a class="ui button" href="{% url 'job_list' project.uid %}?filter={{ analysis.id }}">
                <i class="area chart icon"></i> Go to Results
            </a>

            <a class="ui button" href="{% url 'recipe_edit' analysis.id %}">
                <i class="write icon"></i>Edit Info
            </a>

            <a class="ui button" href="{% url 'recipe_code' analysis.id %}">
                <i class="list icon"></i> Edit Recipe
            </a>

        </div>

        <div class="ui secondary segment">

            <div>{{ analysis.html|safe }}</div>
        </div>

        <div class="ui segment">

            <div class="ui header">Recipe Actions</div>

            <p>The following actions allow you to create your own versions of the recipe.</p>
            <form class="ui form" method="post" action="{% url 'recipe_view' analysis.id %}">

                {% csrf_token %}

                {% copy_interface projects=projects form=form duplicate=analysis.project.id %}

                <button type="submit" class="ui button">
                    <i class="check icon"></i>Submit
               </button>

            </form>

        </div>

    </div>

{% endblock %}
