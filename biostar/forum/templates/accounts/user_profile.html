{% extends "forum_base.html" %}
{% load forum_tags %}

{% block headtitle %}{{ user.profile.name }}{% endblock %}

{% block content %}

    <div class="ui center aligned basic segment">

        <div class="ui aligned large header">
            {{ user.profile.get_role_display }}: {{ user.profile.name }}
        </div>
    </div>

    <div class="ui horizontal segments no-shadow" style="border: none">

        <div class="ui center aligned large segment">

            <div class="ui circular image">
                {% gravatar user=user size=200 %}
            </div>

            <div><a href="{% url "user_profile" user.profile.uid %}">{{ user.profile.name }}</a>
                {{ user |show_score_icon }}{{ user.profile.score | show_score }}
            </div>

            {% if can_moderate %}
                <a class="ui orange moderate-user profile label" data-value="{{ user.profile.uid }}"
                   mod-url="{% url 'user_moderate' user.profile.uid %}">
                    Moderate</a>
                <div class="ui left aligned basic large segment" style="margin:0;padding:0;">
                    <div id="mod-container-{{ user.profile.uid }}"></div>
                </div>
            {% endif %}


            {% if request.user.is_superuser and debugging %}
                <a class="ui profile label" href="{% url 'debug_user' %}?uid={{ user.profile.uid }}">
                    <i class="address card icon"></i> Log in as user
                </a>
            {% endif %}

        </div>

        <div class="ui large segment">
            {% if can_moderate or request.user == user %}
                {% if user.profile.email_verified %}
                    <div class="ui top left attached basic green large label">
                        <i class="check icon"></i> Email Verified
                    </div>{% endif %}
            {% endif %}

            <div class="ui relaxed list">
                <div class="item">
                    <b>Reputation</b>: {{ user.profile.score | show_score }}
                </div>
                <div class="item">
                    <b>Status</b> : {{ user.profile.get_state_display }}
                </div>
                <div class="item">
                    <b>Location</b> : {{ user.profile.location }}
                </div>

                {% if user.profile.last_login %}
                    <div class="item">
                        <b>Last seen </b> : {{ user.profile.last_login |time_ago }}
                    </div>
                {% endif %}
                <div class="item">
                    <b>Joined</b> : {{ user.profile.date_joined|time_ago }}
                </div>
                {% if user == request.user %}
                    <div class="item"><b>Email</b> : {{ user.email }}</div>
                {% else %}
                    <div class="item"><b>Email</b> : {{ user |show_email }}</div>
                {% endif %}


                <div class="item"><b>Handle</b> : <a
                href="{% url 'compose' %}?initial={{ user.username }}">@{{ user.username }}</a>
                </div>
            </div>

            {% if user == request.user %}
                <a class="ui profile label" href="{% url 'edit_profile' %}">
                    <i class="write icon"></i>Edit profile
                </a>
            {% endif %}
        </div>
    </div>

    {{ user.profile.html |safe }}

{% endblock %}