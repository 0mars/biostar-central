{% extends "forum_list.html" %}
{% load forum_tags %}
{% load accounts_tags %}

{% block headtitle %}
    Messages
{% endblock %}

{% block body %}

<div class="center-text">
{% pages objs=all_messages %}
</div>

<table class="ui very basic striped table">
    <tbody>
        {% for message in all_messages %}
                <tr>
                    <td class="{% if message.unread %} new-message {% endif %}">
                      <div class="item">
                        <div class="content">
                            {{ message.sent_date|timesince }} ago: <span class="inline-message">{{ message.body.html|safe }}</span>
                        </div>
                      </div>
                    </td>
                </tr>
        {% empty %}
        <div class="ui message">No messages</div>
        {% endfor %}
    </tbody>
</table>

{#  this will reset the user unread messages #}
{% messages_read user=request.user %}

<div class="center-text">
{% pages objs=all_messages %}
</div>


{% endblock %}

{% block sidebar %}

<div class="ui large biostar-feed">

    <div class="event">
        <div class="ui container">
                <b> Messages by: </b>
                <div class="ui relaxed list" >
                    {% for message in all_messages %}
                       <div class="item spaced" >
                       <img class="ui centered circular image" src="{% gravatar user=message.sender size=30 %}">
                            <a href="{% url 'user_profile' message.sender.profile.uid %}">
                                {{ message.sender.profile.name }}
                                {% user_icon user=message.sender %}
                            </a>

                       </div>
                    {% empty %}
                        No messages
                    {% endfor %}
                </div>
        </div>
    </div>


</div>


{% endblock %}
