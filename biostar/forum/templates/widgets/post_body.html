{% load forum_tags %}

{#  Post anchor. #}
<a name="{{ post.uid }}"></a>

<div class="post view {{ post.css }}" data-value="{{ post.uid }}">

    {#  Post title. #}
    {% if post.is_toplevel %}
        <div class="title">{{ post.title_prefix }}{{ post.title }}</div>
    {% endif %}

    {#  Post body #}
    <div class="body">

        {#  Voting regions #}
        <div class="voting">
            <button class="upvote ui icon button"
                    data-state="{{ post.has_upvote }}"><i class="thumbs up icon"></i>
            </button>

            <div class="score">{{ post.vote_count }}</div>
            <button class="bookmark ui icon button"
                    data-state="{{ post.has_bookmark }}"><i class="bookmark icon"></i>
            </button>

            {% if post.can_accept %}
                <button class="accept ui icon button"
                        data-state="{{ post.accept_count }}"><i class="check circle icon"></i>
                </button>
            {% endif %}
        </div>

        {# Html content, user box, tags, etc #}
        <div class="droppable content">
            <div>
                <div class="ui inverted dimmer">
                    <div class="ui text loader">
                        <div class="muted">Entering edit mode</div>
                    </div>
                </div>

                <div class="wrap magnify draggable" draggable="true">

                    {# Display post author. #}
                    {% post_user_box target_user=post.author %}

                    {# Display post content. #}
                    {% if post.is_editable %}
                        <div class="editable">{{ post.html|safe }}</div>
                    {% else %}
                        {{ post.html|safe }}
                    {% endif %}
                </div>

                <div class="bottom">
                    {# Show tags #}
                    {% if post.is_toplevel %}
                        {% post_tags post=post show_views=True %}
                    {% endif %}

                    {# Show the post actions #}
                    {% post_actions post=post %}
                </div>
            </div>

            {# Render all comments #}
            {% render_comments tree=tree post=post %}
        </div>
    </div>
</div>




