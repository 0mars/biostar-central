{% extends "base.nosidebar.html" %}

{% load basic %}
{% load humanize %}

{% block subheader %}
  <h2>{{root.get_title }}</h2>
{% endblock %}

{% block custom-frameworks %}
    <!-- AJAX -->
    <script src="{{ STATIC_URL }}js/vote.js"></script>
    <script src="{{ STATIC_URL }}js/mod.js"></script>
    <script src="{{ STATIC_URL }}js/comment.js"></script>

    <!-- markitUp editor -->
    <script type="text/javascript" src="{{ STATIC_URL }}markitup/jquery.markitup.js"></script>
    <link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}markitup/skins/markitup/style.css" />
    <link rel="stylesheet" href="{{ STATIC_URL }}markitup/sets/markdown/style.css" type="text/css"/>
    <script type="text/javascript" src="{{ STATIC_URL }}markitup/sets/markdown/set.js"></script>
    <script type="text/javascript" >
        $(document).ready(function() {
            $("#editor").markItUp(mySettings);
        });
    </script>
{% endblock %}

{% block mainbar %}
    <div class="content"">
        
        <div>
            {% render_post request root tree %}              
        <div>
        
        {% if root.closed %}
        <div class="moderated">
            This question has been closed by a moderator
        </div>
        {% endif %}
    
        {% if root.deleted %}
        <div class="moderated">
            This question has been deleted by a moderator
        </div>
        {% endif %}
    
        <div class="answers">
            <div class="count">
                {% if root.answer_count %}
                     {{root.answer_count}} answers
                {% else %}
                    No answers. Add one!
                {% endif %}
            </div>
            
            {% for answer in answers %}
                {% render_post request answer tree %}
                <div class="separator"></div>
            {% endfor %}
        </div>
        
           <div id="post-answer">
                <h2>Your Answer</h2>

                {% if user.is_authenticated %}
                
                <form action="/new/answer/{{root.id}}/" method="post">
                    {% csrf_token %}
                    <textarea id="editor" name="content" cols="50" rows="15" ></textarea>
                    <div>
                        <div id="markItUpPreview" class="markItUpPreview"
                        style="padding-top: 5px"></div>
                    </div>

                    <div align="center">
                        <input style="margin:10px;" type="submit" name="submit" value="Post Your Answer">
                    </div>
                </form>
                
                {% else %}
                    <div>
                        Please <a href="/openid/login/">log in</a> to post an answer.
                    </div>
                {% endif %}
                
            </div>
    </div>
{% endblock %}
